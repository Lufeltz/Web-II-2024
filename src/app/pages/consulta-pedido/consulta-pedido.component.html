<div class="background">
    <div class="d-flex justify-content-center align-items-center" style="height: 100vh;">
        <div class="container">
            <div class="card shadow-lg custom-card border-0">
                <div class="card-body">


                    <form #formConsultaPedido="ngForm" class="container-form d-flex flex-column justify-content-start">
                        <div class="container-consulta-pedido-texto">
                            <h5 class="consulta-pedido-text card-title">Consultar Pedido</h5>
                            <h6 class="consulta-pedido-phrase card-subtitle">Busque aqui seus pedidos por código.</h6>
                        </div>

                        <div class="d-flex align-items-start justify-content-start mb-3">
                            <div class="imput-form" style="flex: 1;">
                                <div id="form-floating-consulta-pedido">
                                    <div class="form-floating">
                                        <input type="text" class="form-control custom-input" name="consulta" id="consulta" placeholder=" " [(ngModel)]="consultaPedido" 
                                        #consulta="ngModel" required pattern="[0-9]*" [class.invalid-border]="consulta.invalid && (consulta.dirty || consulta.touched)" maxlength="12"/>
                                        <label for="consulta">Código do pedido</label>
                                    </div>
                                </div>
                                <div *ngIf="consulta.errors && (consulta.dirty || consulta.touched)" class="left-align text-danger">
                                    <div [hidden]="!consulta.errors['required']">Insira o código do pedido</div>
                                    <div [hidden]="!consulta.errors['pattern']">Insira somente números</div>
                                </div>
                            </div>

                            <div class="container-button">
                                <button type="submit" class="btn btn-primary custom-btn custom-btn-consultar" (click)="consultar()" [disabled]="!formConsultaPedido.form.valid">Consultar</button>
                            </div>
                        </div>
                    </form>


                    <div class="container-table table-responsive" *ngIf="pedidoEncontrado === true">
                        <table class="table table-striped table-hover">

                            <thead>
                                <tr class="custom-tr-borderless">
                                    <div class="custom-card-pedido-number card">
                                        <td colspan="2" id="codigo-pedido-text">N° do pedido: <span id="codigo-pedido-results">{{ codigoPedido }}</span></td>
                                    </div>
                                </tr> 
                                <tr class="custom-tr-borderless">
                                    <td class="situacao-prazo-pedido-text">
                                        Situação: 
                                        <span [ngClass]="{
                                            'text-yellow': situacaoPedido === 'EM ABERTO',
                                            'text-red': situacaoPedido === 'REJEITADO' || situacaoPedido === 'CANCELADO',
                                            'text-gray': situacaoPedido === 'RECOLHIDO',
                                            'text-blue': situacaoPedido === 'AGUARDANDO PAGAMENTO',
                                            'text-orange': situacaoPedido === 'PAGO',
                                            'text-green': situacaoPedido === 'FINALIZADO'}">
                                            {{ situacaoPedido }}
                                        </span>
                                    </td>
                                    <td class="situacao-prazo-pedido-text">Prazo: <span id="prazo-pedido-results">{{ prazo }}</span></td>
                                </tr>
                                <tr class="custom-headers-tfoot">
                                    <th scope="col">Itens:</th>
                                    <th scope="col">Valor:</th>
                                </tr>
                            </thead>

                            <tbody class="table-items-body custom-tr-items">
                                <tr class="unbreakable" *ngFor="let item of mapPedido.get('descricaoRoupa'); let i = index">
                                    <td class="unbreakable">{{ mapPedido.get('descricaoRoupa')[i] }}</td>
                                    <td class="unbreakable">{{ mapPedido.get('precoRoupa')[i] | currency:'BRL' }}</td>
                                </tr>
                            </tbody>
                            
                            <tfoot class="custom-headers-tfoot">
                                <tr> 
                                    <th>Valor total:</th>
                                    <th>{{ precoTotal | currency:'BRL' }}</th>
                                </tr>
                            </tfoot>

                        </table>
                    </div>

                    <div *ngIf="pedidoEncontrado === false" class="alert-container">
                        <div class="alert-container row justify-content-center">
                            <div class="alert alert-danger mt-3 text-center">
                                <p class="mb-0">Nenhum pedido encontrado para o código <strong>{{ consultaPedidoSubmetido }}</strong>.</p>
                                <p class="mb-0">Revise o código informado e tente novamente.</p>
                            </div>
                        </div>
                    </div>

                    <div class="container-button d-flex justify-content-end mt-auto">
                        <button type="button" class="btn btn-primary custom-btn custom-btn-voltar" routerLink="">Voltar</button>
                    </div>
                    

                </div>
            </div>
        </div>
    </div>
</div>
