<h1 class="text-center">Pedidos em aberto</h1>

<div class="m-5">
  <div>
    <select (change)="filtroPedidos($event)" class="form-select">
      <option [value]="statusEnum.EM_ABERTO">EM ABERTO</option>
      <option [value]="statusEnum.REJEITADO">REJEITADO</option>
      <option [value]="statusEnum.CANCELADO">CANCELADO</option>
      <option [value]="statusEnum.AGUARDANDO_PAGAMENTO">
        AGUARDANDO PAGAMENTO
      </option>
      <option [value]="statusEnum.RECOLHIDO">RECOLHIDO</option>
      <option [value]="statusEnum.PAGO">PAGO</option>
      <option [value]="statusEnum.FINALIZADO">FINALIZADO</option>
    </select>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th scope="col">Id</th>
        <th scope="col">Situação</th>
        <th scope="col">Data Criação</th>
        <th scope="col">Roupas</th>
        <th scope="col">Prazo do serviço</th>
        <th scope="col">Preço total</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      @for(pedido of filteredPedidos; track pedido.id){
      <tr
        class="
            {{
          pedido.situacao.tipoSituacao === statusEnum.EM_ABERTO
            ? 'table-warning'
            : ''
        }}
            {{
          pedido.situacao.tipoSituacao === statusEnum.REJEITADO ||
          pedido.situacao.tipoSituacao === statusEnum.CANCELADO
            ? 'table-danger'
            : ''
        }}
            {{
          pedido.situacao.tipoSituacao === statusEnum.RECOLHIDO
            ? 'table-secondary'
            : ''
        }}
            {{
          pedido.situacao.tipoSituacao === statusEnum.AGUARDANDO_PAGAMENTO
            ? 'table-info'
            : ''
        }}
            {{
          pedido.situacao.tipoSituacao === statusEnum.PAGO
            ? 'table-success'
            : ''
        }}
            {{
          pedido.situacao.tipoSituacao === statusEnum.FINALIZADO
            ? 'table-primary'
            : ''
        }}
        "
      >
        <td>{{ pedido.id }}</td>
        <td>{{ pedido.situacao.tipoSituacao }}</td>
        <td>{{ pedido.dataPedido }}</td>

        <td>
          <ul class="list-group">
            @for(roupa of pedido.listaPedidoRoupa; track roupa.id){
            <li>
              {{ roupa.roupa.descricao }}, R${{ roupa.roupa.preco }},
              {{ roupa.roupa.prazoDias }} Dias
            </li>
            }
          </ul>
        </td>

        <td>{{ pedido.orcamento.dataPrazo }} Min</td>
        <td>R$ {{ pedido.orcamento.valor }}</td>

        <td>
          @if(pedido.situacao.tipoSituacao == statusEnum.AGUARDANDO_PAGAMENTO){
          <button type="button" class="btn btn-success" (click)="abrirModal(pedido)">Pagar</button>
          } @if(pedido.situacao.tipoSituacao == statusEnum.EM_ABERTO){
          <button type="button" class="btn btn-danger">Cancelar</button>
          }
        </td>
      </tr>
      }
    </tbody>
  </table>
</div>
